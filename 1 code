#include "Utils.h"
#include "MemMap.h"
#include "StdTypes.h"
#include "DIO_interface.h"  
#include "MOTOR_interface.h"
#include "LCD.h"
#include "KeyPad.h"
#include "Stepper.h"
#include "ADC.h"
#include "Sensors.h"
#include "EX_Interrupt.h"
#include "Timers.h"
#include "SERVO.h"
#include "RGB.h"
#include "Converter.h"
#include "ULTRASONIC.h"
#include "UART.h"

#define Buzzer_ON DIO_WritePin(PINC5,HIGH)
#define Buzzer_OFF DIO_WritePin(PINC5,LOW)

 void func_OCA(void)
 {
	DIO_WritePin(PINC5,LOW);
 }
void func_OCB(void)
{
DIO_WritePin(PINC5,HIGH);
}


int main(void)
{
    sei(); // enable global interrupt
/*******************************Initilization *******************************/
	DIO_Init();
	LCD_Init();

	ADC_Init(VREF_VCC,ADC_SCALER_64);
UART_Init();
/*********************************** Interrupt*******************************/
	
	/*EXI_TriggerEdge(EX_INT1,FALLING_EDGE);
	EXI_Enable(EX_INT1);*/
	// EXI_SetCallBack(EX_INT1,functio1);
/************************ Timer ****************************/
	/*TIMER0_Init(TIMER0_FASTPWM_MODE,TIMER0_SCALER_8);
	TIMER0_OC0Mode(OC0_NON_INVERTING);
	
	Timer1_Init(TIMER1_FASTPWM_ICR_TOP_MODE,TIMER1_SCALER_8); // fast pwm mode scaler 8
	Timer1_OCRA1Mode(OCRA_NON_INVERTING);
	Timer1_OCRB1Mode(OCRA_NON_INVERTING);
	
	Timer1_OCB_InterruptEnable();
	Timer1_OCA_InterruptEnable();
	Timer1_OCA_SetCallBack(func_OCA);
	Timer1_OCB_SetCallBack(func_OCB);*/
/********************************************************/
Timer1_Init(TIMER1_NORMAL_MODE,TIMER1_SCALER_8);
ULTRASONIC_Init();
/*
 LCD_GoTo_WriteString(0,0,"One-Byte Converter");
 LCD_GoTo_WriteString(1,0,"DEC   HEX   BIN");
 _delay_ms(3000);
 LCD_Clear();*/

u16 d=0 ;
u32 t=0;
LCD_GoTo_WriteString(0,0,"UART");

u8 x='A';
UART_Send('G');
UART_SendString("Mohamed Ahmed");
    while(1)
    {
		

if(UART_ReceivePerodic(&d))
{
	LCD_GoTo_WriteNumber(1,0,d);	
}
	
	    /*
	    // First Time Display
	    if(Enter_flag==0)
	    {
		    LCD_GoTo_WriteString(0,0,"Convert From :");
		    LCD_GoTo_WriteString(1,0,"1-D   2-H   3-B");
		    Enter_flag=1;
	    }
	    
	    // A keypad function to get the key that has been pressed.
	    k = KEYPAD_GetKey();
	    if(k!=(NO_KEY))
	    {
		    // 1 - Decimal Operations
		    while(k==DECIMAL)
		    {
			    Decimal_Operation()				;
		    }
		    // 2 - Hex Operations
		    while(k==HEXA)
		    {
			    Hex_Operation();
		    }
		    //  3 - Binary Operations
		    while(k==BINARY)
		    {
			    Binary_Operation();
		    }
	    }*/
    }
}
 
 

 