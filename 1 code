
#include "Utils.h"
#include "MemMap.h"
#include "StdTypes.h"
#include "DIO_interface.h"  
#include "MOTOR_interface.h"
#include "LCD.h"
#include "KeyPad.h"
#include "Stepper.h"
#include "ADC.h"
#include "Sensors.h"
 

 /******************** Declrations *********************/
void DecimalToHex(void);
void DecimalToBinary(void);
void CLEAR_Decimal(void);
void Decimal_Operation(void);

void BinaryToHex(void);
void BinaryToDecimal(void);
void CLEAR_Binary(void);
void Binary_Operation(void);

void HexToBinary(void);
void HexToDecimal(void);
void CLEAR_Hex(void);
void Hex_Operation(void);
 /******************** Globals *********************/
#define DECIMAL '1'
#define HEXA '2'
#define BINARY '3'

 u8 k=NO_KEY ,flag=0;
 //u32 num=0;
 u16 num=0;
  u16 num2=0;

 u8 Enter_flag=0;
 
 u16 temp=0;

int main(void)
{
	/*******************************Initilization *******************************/
	DIO_Init();
	LCD_Init();
	ADC_Init(ADC_VCC,ADC_SCALER_64);
	/**************************************************************************/
	/*******************************task LCD *******************************/
		/*LCD_GoTo(0,0) ;
		LCD_WriteString("Hello");
		_delay_ms(700);*/
/**************************************************************************/
 

    while(1) 
    {
		
		
 		// First Time Display
		if(Enter_flag==0) 
		{
		LCD_GoTo_WriteString(0,0,"Convert From :");
		LCD_GoTo_WriteString(1,0,"1-D   2-H   3-B");
		Enter_flag=1;	
		}
		
		// A keypad function to get the key that has been pressed.
		k = KEYPAD_GetKey(); 
		if(k!=NO_KEY )
		{    
			 // 1 - Decimal Operations 
			 while(k==DECIMAL) 
				{	
					Decimal_Operation();
				}
			 // 2 - Hex Operations 
			 while(k==HEXA)  
			 {
				 Hex_Operation();
			 }
			 //  3 - Binary Operations 
			 while(k==BINARY) 
			 {
				 Binary_Operation();
			 }			 
		}		 		 
	}
}



/******************** Decimal Operation *********************/
void DecimalToHex(void)
{
	LCD_Clear();
	LCD_GoTo_WriteString(0,0,"D :                    ");
	LCD_GoTo_WriteString(1,0,"H :                    ");
	while (1)
	{
		k = KEYPAD_GetKey();
		if(k!=NO_KEY )
		{
			num=num*10+(k-'0');
			if(k=='C')
			{
				LCD_Clear();
				LCD_GoTo_WriteString(0,0,"Convert To :     ");
				LCD_GoTo_WriteString(1,0,"2-H   3-B             ");
				num=0;
				k=NO_KEY;
				_delay_ms(600);
				break;
			}
		}
		LCD_GoTo_WriteNumber(0,4,num);
		LCD_GoTo(1,4) ;
		LCD_WriteHEX(num);
	}
	
}
void DecimalToBinary(void)
{
	LCD_Clear();
	LCD_GoTo_WriteString(0,0,"D :                    ");
	LCD_GoTo_WriteString(1,0,"B :                    ");
	while (1)
	{
		k = KEYPAD_GetKey();
		if(k!=NO_KEY )
		{
			num=num*10+(k-'0');
			if(k=='C')
			{
				LCD_Clear();
				LCD_GoTo_WriteString(0,0,"Convert To :     ");
				LCD_GoTo_WriteString(1,0,"2-H   3-B             ");
				num=0;
				k=NO_KEY;
				_delay_ms(600);
				break;
			}
		}
		LCD_GoTo_WriteNumber(0,4,num);
		LCD_GoTo(1,4) ;
		LCD_WriteBinary(num);
	}
}
void CLEAR_Decimal(void)
{
	Enter_flag=0;
	LCD_Clear();
	LCD_GoTo_WriteString(0,0,"Convert From :");
	LCD_GoTo_WriteString(1,0,"1-D   2-H   3-B");
}
void Decimal_Operation(void)
{

	LCD_GoTo_WriteString(0,0,"Convert To :     ");
	LCD_GoTo_WriteString(1,0,"2-H   3-B             ");
	while (1)
	{
		k = KEYPAD_GetKey();
		if(k!=NO_KEY )
		{
			if(k==HEXA) // if you want to Convert from Deci to Hexa
			{
				DecimalToHex();
				
			}
			if(k==BINARY) // Convert from Deci to Binary
			{
				DecimalToBinary();
			}
			if(k=='C') // reset
			{
				CLEAR_Decimal();
				break;
			}
		}
	}
}
/********************                  *********************/

/******************** Binary Operation *********************/
void BinaryToHex(void)
{
	LCD_Clear();
	LCD_GoTo_WriteString(0,0,"B :                    ");
	LCD_GoTo_WriteString(1,0,"H :                    ");
	while (1)
	{
		k = KEYPAD_GetKey();
		if(k!=NO_KEY )
		{
			if(k=='1')
			{
				num=num*10+(k-'0');
			}
			if (k=='0')
			{
				num=num*10;
			}
			if(k=='C')
			{
				LCD_Clear();
				LCD_GoTo_WriteString(0,0,"Convert To :     ");
				LCD_GoTo_WriteString(1,0,"1-B   2-H             ");
				num=0;
				k=NO_KEY;
				_delay_ms(600);
				break;
			}
		}
		LCD_GoTo_WriteNumber(0,4,num);
		LCD_GoTo(1,4) ;
		LCD_WriteBinaryToHex(num);
	}
	
}
void BinaryToDecimal(void)
{
	LCD_Clear();
	LCD_GoTo_WriteString(0,0,"B :                    ");
	LCD_GoTo_WriteString(1,0,"D :                    ");
	while (1)
	{
		k = KEYPAD_GetKey();
		if(k!=NO_KEY )
		{
			if(k=='1')
			{
				num=num*10+(k-'0');
			}
			if (k=='0')
			{
				num=num*10;
			}
			if(k=='C')
			{
				LCD_Clear();
				LCD_GoTo_WriteString(0,0,"Convert To :     ");
				LCD_GoTo_WriteString(1,0,"1-D   2-H             ");
				num=0;
				k=NO_KEY;
				_delay_ms(600);
				break;
			}
		}
		LCD_GoTo_WriteNumber(0,4,num);
		LCD_GoTo(1,4) ;
		LCD_WriteBinaryToDecimal(num);
		
		
	}
}
void CLEAR_Binary(void)
{
	Enter_flag=0;
	LCD_Clear();
	LCD_GoTo_WriteString(0,0,"Convert From :");
	LCD_GoTo_WriteString(1,0,"1-D   2-H   3-B");
}
void Binary_Operation(void)
{

	LCD_GoTo_WriteString(0,0,"Convert To :     ");
	LCD_GoTo_WriteString(1,0,"1-D   2-H             ");
	while (1)
	{
		k = KEYPAD_GetKey();
		if(k!=NO_KEY )
		{
			if(k==DECIMAL) // if you want to Convert from Deci to Hexa
			{
				BinaryToDecimal();
				
			}
			if(k==HEXA) // Convert from Deci to Binary
			{
				BinaryToHex();
			}
			if(k=='C') // reset
			{
				CLEAR_Binary();
				break;
			}
		}
	}
}
/********************                  *********************/

/******************** Hexadecimal Operation *********************/
void HexToBinary(void)
{
	LCD_Clear();
	LCD_GoTo_WriteString(0,0,"H :0x                    ");
	LCD_GoTo_WriteString(1,0,"B :                    ");
	while (1)
	{
		k = KEYPAD_GetKey();
		if(k!=NO_KEY )
		{
			
			num=num*10+(k-'0');
			
			if(k=='C')
			{
				LCD_Clear();
				LCD_GoTo_WriteString(0,0,"Convert To :     ");
				LCD_GoTo_WriteString(1,0,"1-D   3-B             ");
				num=0;
				k=NO_KEY;
				_delay_ms(600);
				break;
			}
		}
		
		LCD_GoTo_WriteNumber(0,6,num);
		LCD_GoTo(1,4) ;
		LCD_WriteBinaryToHex(num);
		
	}
	
}
void HexToDecimal(void)
{
	LCD_Clear();
	LCD_GoTo_WriteString(0,0,"H :0x                  ");
	LCD_GoTo_WriteString(1,0,"D :                    ");
	while (1)
	{
		k = KEYPAD_GetKey();
		if(k!=NO_KEY )
		{
				num=num*10+(k-'0');

			if(k=='C')
			{
				LCD_Clear();
				LCD_GoTo_WriteString(0,0,"Convert To :     ");
				LCD_GoTo_WriteString(1,0,"1-D   3-B             ");
				num=0;
				k=NO_KEY;
				_delay_ms(600);
				break;
			}
		}
		LCD_GoTo_WriteNumber(0,6,num);
		LCD_GoTo(1,4) ;
		LCD_WriteHEXToDecimal(num);
		
		
	}
}
void CLEAR_Hex(void)
{
	Enter_flag=0;
	LCD_Clear();
	LCD_GoTo_WriteString(0,0,"Convert From :");
	LCD_GoTo_WriteString(1,0,"1-D   2-H   3-B");
}
void Hex_Operation(void)
{

	LCD_GoTo_WriteString(0,0,"Convert To :     ");
	LCD_GoTo_WriteString(1,0,"1-D   3-B             ");
	while (1)
	{
		k = KEYPAD_GetKey();
		if(k!=NO_KEY )
		{
			if(k==BINARY) // if you want to Convert from Deci to Hexa
			{
				HexToBinary();
				
			}
			if(k==DECIMAL) // Convert from Deci to Binary
			{
				HexToDecimal();
			}
			if(k=='C') // reset
			{
				CLEAR_Hex();
				break;
			}
		}
	}
}
/********************                  *********************/
